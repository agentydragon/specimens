rationale: |
  Timestamp units are inconsistent across SQL sources, generated sqlc code, and (by extension) calling Go code.

  Findings (evidence excerpts):
  - messages.sql uses microseconds (julianday Ã— 86400000000) for created_at/updated_at.
  - messages.sql.go (generated) still updates updated_at using seconds via strftime('%s','now').
  - files.sql.go uses microseconds for created_at/updated_at in INSERT, diverging from messages.

  Why it matters
  - Delta/watermark queries that rely on created_at/updated_at ordering can break (skips/duplicates,
  out-of-order).
  - Mixed units undermine tie-breaking semantics in (updated_at, id) ordered scans.

  Acceptance criteria
  - Pick a single unit (prefer microseconds) for all created_at/updated_at writes.
  - Align SQL and regenerate sqlc so generated code matches sources.
  - Re-run ordering/delta queries to confirm monotonic ordering and stable pagination.

  Notes
  - Ordering drift (created_at, rowid) is filed separately; this issue is strictly about unit consistency.
should_flag: true
occurrences:
- occurrence_id: occ-0
  files:
    internal/db/files.sql.go:
    - 18
    - 24
    internal/db/messages.sql.go:
    - 260
    - 270
    internal/db/migrations/20250424200609_initial.sql: null
    internal/db/migrations/20250829011000_use_microsecond_timestamps.sql: null
    internal/db/sql/messages.sql:
    - - 19
      - 24
    - - 31
      - 33
  expect_caught_from:
  - - internal/db/sql/messages.sql
    - internal/db/messages.sql.go
  - - internal/db/files.sql.go
