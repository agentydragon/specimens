source_up

# Load devenv integration (caches, helpers)
eval "$(devenv direnvrc)"

# Rebuild env when key definition files change
watch_file pyproject.toml uv.lock devenv.nix

# Activate the devenv-managed environment
use devenv

export VIRTUAL_ENV="$PWD/.devenv/state/venv"
export UV_PROJECT_ENVIRONMENT="$VIRTUAL_ENV"
PATH_add "$VIRTUAL_ENV/bin"

# direnv shim wrappers as fallback
PATH_add .direnv/bin
