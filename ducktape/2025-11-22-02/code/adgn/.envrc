# direnv + devenv (cached) â€” recommended setup for adgn
source_up

# Load devenv's direnv integration (provides caching + helpers)
eval "$(devenv direnvrc)"

# Trigger rebuilds only when dependency definitions change
watch_file pyproject.toml uv.lock devenv.nix

# Activate the devenv-managed uv environment
use devenv

# Activate the devenv-managed venv on PATH so python/pytest/etc. are available
export VIRTUAL_ENV="$PWD/.devenv/state/venv"
PATH_add "$VIRTUAL_ENV/bin"

# direnv shim wrappers (fallbacks; venv bin takes precedence)
PATH_add .direnv/bin

# Default registry endpoint for local pushes
export RSPCACHE_REGISTRY_HOST="registry.k3s.local"
