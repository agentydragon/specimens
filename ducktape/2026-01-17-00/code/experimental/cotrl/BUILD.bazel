load("@rules_python//python:defs.bzl", "py_binary", "py_library", "py_test")
load("//tools/lint:linters.bzl", "ruff_test")

exports_files(["pyproject.toml"])

# Experimental LLM RL scripts - not a proper package, just standalone scripts
py_library(
    name = "cotrl",
    srcs = glob(
        ["*.py"],
        exclude = ["test_*.py"],
    ),
    visibility = ["//visibility:public"],
    deps = [
        "@pypi//pydantic",
    ],
)

py_binary(
    name = "llm_rl_experiment",
    srcs = ["llm_rl_experiment.py"],
    deps = [
        ":cotrl",
        "@pypi//aiofiles",
    ],
)

py_binary(
    name = "analyze_trajectories",
    srcs = ["analyze_trajectories.py"],
    deps = [":cotrl"],
)

py_test(
    name = "test_llm_rl_minimal",
    srcs = ["test_llm_rl_minimal.py"],
    # Integration test - requires OPENAI_API_KEY
    tags = ["manual"],
    deps = [
        ":cotrl",
        "@pypi//gymnasium",
        "@pypi//openai",
        "@pypi//pytest",
    ],
)

ruff_test(
    name = "ruff",
    srcs = [":cotrl"],
)
