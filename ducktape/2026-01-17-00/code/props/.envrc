# Inherit workspace from parent
source_up

# Generate PostgreSQL password if not exists
PASSWORD_FILE=".direnv/pg_password"
mkdir -p .direnv
if [[ ! -f "$PASSWORD_FILE" ]]; then
  openssl rand -base64 24 > "$PASSWORD_FILE"
  chmod 600 "$PASSWORD_FILE"
fi

# PostgreSQL client variables (host-side access to Docker container)
export PGHOST="127.0.0.1"
export PGPORT="5433"
export PGUSER="postgres"
export PGDATABASE="eval_results"
export PGPASSWORD=$(cat "$PASSWORD_FILE")

# Container networking (for Docker Compose and agent containers)
export PROPS_DB_CONTAINER_NAME="props-postgres"
export PROPS_DB_CONTAINER_PORT="5432"

# OCI Registry configuration
export PROPS_REGISTRY_HOST="127.0.0.1"
export PROPS_REGISTRY_PORT="5050"
export PROPS_REGISTRY_PROXY_PORT="5051"
export PROPS_REGISTRY_CONTAINER_NAME="props-registry"
export PROPS_REGISTRY_CONTAINER_PORT="5000"
export PROPS_REGISTRY_PROXY_CONTAINER_NAME="props-registry-proxy"
export PROPS_REGISTRY_PROXY_CONTAINER_PORT="5051"

# Specimens data directory
REPO_ROOT=$(git rev-parse --show-toplevel)
export ADGN_PROPS_SPECIMENS_ROOT="$REPO_ROOT/../specimens"
