"""Alembic database migrations."""

# gazelle:exclude env.py
# gazelle:exclude script.py.mako
# gazelle:exclude versions

load("@rules_python//python:defs.bzl", "py_test")

filegroup(
    name = "migrations",
    srcs = [
        "README",
        "env.py",
        "script.py.mako",
    ] + glob(["versions/*.py"]),
    visibility = ["//props:__subpackages__"],
)

py_test(
    name = "test_migration_sequence",
    srcs = ["test_migration_sequence.py"],
    data = [":migrations"],
    imports = ["../../../.."],
    deps = [
        "@pypi//alembic",
        "@pypi//pytest",
    ],
)
