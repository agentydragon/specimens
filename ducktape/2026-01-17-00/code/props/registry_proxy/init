#!/bin/sh
set -e

# Set up Python path to include all runfiles
cd /app
export PYTHONPATH="/app/proxy_bin.runfiles/_main:$(find /app/proxy_bin.runfiles -type d -name site-packages | tr '\n' ':')"

# Run uvicorn with the proxy app
exec python -m uvicorn \
  props.registry_proxy.proxy:app \
  --host 0.0.0.0 \
  --port "${PORT:-5051}" \
  --log-level "${LOG_LEVEL:-info}"
